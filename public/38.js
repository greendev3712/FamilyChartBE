webpackJsonp([38],{"9juD":function(t,s,i){var a=i("JHwd");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);i("rjj0")("5d1bcf68",a,!0,{})},BTX1:function(t,s,i){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var a=i("NYxO"),e=i("C/JF"),n=i("fhbW"),r=i("NYuj"),l=i.n(r),o=i("lzLf");function c(t){for(var s=1;s<arguments.length;s++){var i=null!=arguments[s]?arguments[s]:{},a=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(i).filter(function(t){return Object.getOwnPropertyDescriptor(i,t).enumerable}))),a.forEach(function(s){u(t,s,i[s])})}return t}function u(t,s,i){return s in t?Object.defineProperty(t,s,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[s]=i,t}e.library.add(n.faUser,n.faSyncAlt,n.faTrashAlt,n.faUpload,n.faSignOutAlt,n.faPencilAlt),s.default={name:"UserProfile",components:{FileUploader:l.a},data:function(){return{profile:null}},computed:c({},Object(a.mapState)(["user","meta","enums","impersonating"]),Object(a.mapState)("auth",["isAuth"]),Object(a.mapState)("layout",["isMobile"]),{uploadAvatarLink:function(){return route("core.avatars.store")},isSelfVisiting:function(){return this.user.id===this.profile.id},avatarId:function(){return this.isSelfVisiting?this.user.avatar.id:this.profile.avatar.id},avatarLink:function(){return route("core.avatars.show",this.avatarId)}}),created:function(){this.isAuth&&this.fetch()},methods:c({},Object(a.mapMutations)(["setUserAvatar","initialise"]),{fetch:function(){var t=this;axios.get(route(this.$route.name,this.$route.params.user)).then(function(s){return t.profile=s.data.user}).catch(function(s){return t.handleError(s)})},updateAvatar:function(){var t=this;axios.patch(route("core.avatars.update",this.user.avatar.id)).then(function(s){var i=s.data;return t.setUserAvatar(i.avatarId)}).catch(function(s){return t.handleError(s)})},exit:function(){var t=this;axios.post("/api/logout").then(function(){t.profile=null,t.$store.commit("initialise",!1),t.$store.commit("auth/logout"),t.$router.push({name:"login"})}).catch(function(s){t.handleError(s)})},dateFormat:function(t){return t?Object(o.a)(t,this.meta.dateFormat):null}})}},FbYI:function(t,s){t.exports={render:function(){var t=this.$createElement,s=this._self._c||t;return s("form",{staticClass:"file-upload is-marginless",on:{submit:function(t){t.preventDefault()}}},[s("input",{ref:"input",staticClass:"file-input hidden",attrs:{multiple:this.multiple,type:"file"},on:{change:this.upload}}),this._v(" "),this._t("upload-button",[s("a",{staticClass:"icon is-small",on:{click:this.openFileBrowser}},[s("fa",{attrs:{icon:"upload"}})],1)],{openFileBrowser:this.openFileBrowser})],2)},staticRenderFns:[]}},HyT4:function(t,s,i){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var a=i("zhG5"),e=i.n(a);s.default={components:{UserProfile:e.a}}},JHwd:function(t,s,i){(t.exports=i("FZ+f")(!1)).push([t.i,".avatar[data-v-e8c2b06c]{margin:auto}.controls[data-v-e8c2b06c],.details[data-v-e8c2b06c]{-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center}.has-left-border[data-v-e8c2b06c]{border-left:1px solid rgba(0,0,0,.2)}.has-right-border[data-v-e8c2b06c]{border-right:1px solid rgba(0,0,0,.2)}.details>.column[data-v-e8c2b06c]{overflow:hidden;text-overflow:ellipsis}",""])},LWgn:function(t,s,i){var a=i("bYT2");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);i("rjj0")("4bc5349f",a,!0,{})},NYuj:function(t,s,i){var a=i("VU/8")(i("lmgV"),i("FbYI"),!1,function(t){i("LWgn")},null,null);t.exports=a.exports},bYT2:function(t,s,i){(t.exports=i("FZ+f")(!1)).push([t.i,"button.file-upload{background:transparent}.file-input.hidden{display:none}",""])},gNfn:function(t,s){t.exports={render:function(){var t=this,s=t.$createElement,i=t._self._c||s;return t.profile?i("div",{staticClass:"box has-background-light has-padding-medium raises-on-hover"},[i("h4",{staticClass:"title is-4 has-text-centered has-margin-top-large"},[i("span",{staticClass:"icon"},[i("fa",{attrs:{icon:"user",size:"xs"}})],1),t._v("\n        "+t._s(t.profile.person.name)+"\n        "),t.profile.person.appellative?i("span",[t._v("\n            ("+t._s(t.profile.person.appellative)+")\n        ")]):t._e()]),t._v(" "),i("hr",{staticClass:"has-background-grey-lighter"}),t._v(" "),i("div",{staticClass:"columns"},[i("div",{staticClass:"column"},[i("div",{staticClass:"columns is-mobile"},[i("div",{staticClass:"column"},[i("figure",{staticClass:"image is-128x128 avatar"},[i("img",{staticClass:"is-rounded",attrs:{src:t.avatarLink}})])]),t._v(" "),i("div",{staticClass:"column"},[i("div",{staticClass:"has-margin-top-small field controls"},[t.isSelfVisiting?i("a",{staticClass:"button is-fullwidth is-primary",on:{click:t.updateAvatar}},[i("span",{staticClass:"icon"},[i("fa",{attrs:{icon:"sync-alt"}})],1),t._v(" "),i("span",[t._v("\n                                "+t._s(t.__("Avatar"))+"\n                            ")])]):t._e(),t._v(" "),t.isSelfVisiting?i("file-uploader",{attrs:{url:t.uploadAvatarLink,"file-key":"avatar"},on:{"upload-successful":function(s){t.setUserAvatar(s.id)}},scopedSlots:t._u([{key:"upload-button",fn:function(s){var a=s.openFileBrowser;return[i("a",{staticClass:"button is-fullwidth is-info has-margin-top-small",on:{click:a}},[i("span",{staticClass:"icon"},[i("fa",{attrs:{icon:"upload"}})],1),t._v(" "),i("span",[t._v("\n                                        "+t._s(t.__("Avatar"))+"\n                                    ")])])]}}])}):t._e(),t._v(" "),t.isSelfVisiting?i("a",{staticClass:"button is-fullwidth is-danger has-margin-top-small",on:{click:function(s){t.exit()}}},[i("span",{staticClass:"icon"},[i("fa",{attrs:{icon:"sign-out-alt"}})],1),t._v(" "),i("span",[t._v("\n                                "+t._s(t.__("Log out"))+"\n                            ")])]):t._e(),t._v(" "),t.isSelfVisiting||!t.canAccess("core.impersonate.start")||t.impersonating?t._e():i("a",{staticClass:"button is-fullwidth is-warning",on:{click:function(s){t.$root.$emit("start-impersonating",t.profile.id)}}},[t._v("\n                            "+t._s(t.__("Impersonate"))+"\n                        ")]),t._v(" "),t.canAccess("administration.users.edit")?i("a",{staticClass:"button is-fullwidth has-margin-top-small is-warning",on:{click:function(s){t.$router.push({name:"administration.users.edit",params:{user:t.profile.id}})}}},[i("span",{staticClass:"icon"},[i("fa",{attrs:{icon:"pencil-alt"}})],1),t._v(" "),i("span",[t._v("\n                                "+t._s(t.__("Edit"))+"\n                            ")])]):t._e()],1)])])]),t._v(" "),i("div",{staticClass:"column"},[t.isMobile?i("hr",{staticClass:"has-background-grey-lighter"}):t._e(),t._v(" "),i("div",{staticClass:"columns is-mobile is-multiline details"},[i("div",{staticClass:"column is-one-third has-text-right has-padding-small"},[i("strong",[t._v(t._s(t.__("Group"))+":")])]),t._v(" "),i("div",{staticClass:"column is-two-thirds has-padding-small"},[i("span",{staticClass:"has-margin-left-medium"},[t._v("\n                        "+t._s(t.profile.group.name)+"\n                    ")])]),t._v(" "),i("div",{staticClass:"column is-one-third has-text-right has-padding-small"},[i("strong",[t._v(t._s(t.__("Role"))+":")])]),t._v(" "),i("div",{staticClass:"column is-two-thirds has-padding-small"},[i("span",{staticClass:"has-margin-left-medium"},[t._v("\n                        "+t._s(t.profile.role.name)+"\n                    ")])]),t._v(" "),i("div",{staticClass:"column is-one-third has-text-right has-padding-small"},[i("strong",[t._v(t._s(t.__("Email"))+":")])]),t._v(" "),i("div",{staticClass:"column is-two-thirds has-padding-small"},[i("span",{staticClass:"has-margin-left-medium"},[t._v("\n                        "+t._s(t.profile.email)+"\n                    ")])]),t._v(" "),i("div",{staticClass:"column is-one-third has-text-right has-padding-small"},[i("strong",[t._v(t._s(t.__("Phone"))+":")])]),t._v(" "),i("div",{staticClass:"column is-two-thirds has-padding-small"},[i("span",{staticClass:"has-margin-left-medium"},[t._v("\n                        "+t._s(t.profile.person.phone)+"\n                    ")])]),t._v(" "),i("div",{staticClass:"column is-one-third has-text-right has-padding-small"},[i("strong",[t._v(t._s(t.__("Birthday"))+":")])]),t._v(" "),i("div",{staticClass:"column is-two-thirds has-padding-small"},[i("span",{staticClass:"has-margin-left-medium"},[t._v("\n                        "+t._s(t.dateFormat(t.profile.person.birthday))+"\n                    ")])]),t._v(" "),i("div",{staticClass:"column is-one-third has-text-right has-padding-small"},[i("strong",[t._v(t._s(t.__("Gender"))+":")])]),t._v(" "),i("div",{staticClass:"column is-two-thirds has-padding-small"},[i("span",{staticClass:"has-margin-left-medium"},[t._v("\n                        "+t._s(t.profile.person.gender?t.enums.genders._get(t.profile.person.gender):null)+"\n                    ")])])])])]),t._v(" "),i("hr",{staticClass:"has-background-grey-lighter"}),t._v(" "),i("div",{staticClass:"level is-mobile has-margin-bottom-large"},[i("div",{staticClass:"level-item has-text-centered has-right-border"},[i("div",[i("p",{staticClass:"subtitle is-3"},[t._v("\n                    "+t._s(t.profile.loginCount)+"\n                ")]),t._v(" "),i("p",{staticClass:"subtitle is-4"},[t._v("\n                    "+t._s(t.__("logins"))+"\n                ")])])]),t._v(" "),i("div",{staticClass:"level-item has-text-centered"},[i("div",[i("p",{staticClass:"subtitle is-3"},[t._v("\n                    "+t._s(t.profile.actionLogCount)+"\n                ")]),t._v(" "),i("p",{staticClass:"subtitle is-4"},[t._v("\n                    "+t._s(t.__("actions"))+"\n                ")])])]),t._v(" "),i("div",{staticClass:"level-item has-text-centered has-left-border"},[i("div",[i("p",{staticClass:"subtitle is-3"},[t._v("\n                    "+t._s(t.profile.rating)+"\n                ")]),t._v(" "),i("p",{staticClass:"subtitle is-4"},[t._v("\n                    "+t._s(t.__("rating"))+"\n                ")])])])])]):t._e()},staticRenderFns:[]}},lmgV:function(t,s,i){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var a=i("C/JF"),e=i("fhbW");function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function r(t,s){return function(t){if(Array.isArray(t))return t}(t)||function(t,s){var i=[],a=!0,e=!1,n=void 0;try{for(var r,l=t[Symbol.iterator]();!(a=(r=l.next()).done)&&(i.push(r.value),!s||i.length!==s);a=!0);}catch(t){e=!0,n=t}finally{try{a||null==l.return||l.return()}finally{if(e)throw n}}return i}(t,s)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}a.library.add(e.faUpload),s.default={name:"FileUploader",props:{multiple:{type:Boolean,default:!1},url:{type:String,required:!0},fileSizeLimit:{type:Number,default:2e7},params:{type:Object,default:null},fileKey:{type:String,default:"file"}},data:function(){return{input:null,formData:new FormData,succesfull:0}},methods:{openFileBrowser:function(){this.$refs.input.click()},upload:function(){var t=this;this.$emit("upload-start"),this.setFormData(),0!==this.succesfull&&axios.post(this.url,this.formData).then(function(s){t.reset(),t.$emit("upload-successful",s.data)}).catch(function(s){t.reset(),t.$emit("upload-error");var i=s.response,a=i.data;422!==i.status?t.handleError(s):Object.keys(a.errors).forEach(function(s){return t.$toastr.error(a.errors[s][0])})})},setFormData:function(){var t=this.$refs.input.files;this.addFiles(t),this.succesfull>0&&this.addParams()},addFiles:function(t){if(this.multiple)for(var s=0;s<t.length;s++)this.sizeCheckPasses(t[s])&&(this.addFile("".concat(this.fileKey,"_").concat(s),t[s]),this.succesfull++);else this.addFile(this.fileKey,t[0])},addFile:function(t,s){this.sizeCheckPasses(s)&&(this.formData.append(t,s),this.succesfull++)},addParams:function(){var t=this;this.params&&Object.entries(this.params).forEach(function(s){var i=r(s,2),a=i[0],e=i[1],l="object"===n(e)?JSON.stringify(e):e;t.formData.append(a,l)})},sizeCheckPasses:function(t){return!(t.size>this.fileSizeLimit)||(this.$toastr.warning("File size Limit of ".concat(this.fileSizeLimit," Kb exceeded by ").concat(t.name)),!1)},reset:function(){this.$el.reset(),this.formData=new FormData,this.succesfull=0}}}},vcmO:function(t,s,i){var a=i("VU/8")(i("HyT4"),i("xfXU"),!1,null,null,null);t.exports=a.exports},xfXU:function(t,s){t.exports={render:function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"columns is-multiline is-centered"},[s("div",{staticClass:"column is-two-thirds-desktop"},[s("user-profile")],1)])},staticRenderFns:[]}},zhG5:function(t,s,i){var a=i("VU/8")(i("BTX1"),i("gNfn"),!1,function(t){i("9juD")},"data-v-e8c2b06c",null);t.exports=a.exports}});
//# sourceMappingURL=38.js.map