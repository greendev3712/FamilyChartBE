{"version":3,"sources":["webpack:///./resources/js/pages/notifications/Index.vue?bd2f","webpack:///resources/js/pages/notifications/Index.vue","webpack:///./resources/js/pages/notifications/Index.vue"],"names":["module","exports","render","_vm","this","_h","$createElement","_c","_self","staticClass","notifications","on","click","updateAll","_v","_s","__","attrs","icon","_e","class","is-loading","loading","fetch","destroyAll","tag","enter-active-class","leave-active-class","_l","notification","key","id","is-bold","read_at","data","has-text-info","path","$event","update","body","timeFromNow","created_at","destroy","index","length","staticRenderFns","__WEBPACK_IMPORTED_MODULE_2__fortawesome_fontawesome_svg_core__","add","__WEBPACK_IMPORTED_MODULE_3__fortawesome_free_solid_svg_icons__","__webpack_exports__","limit","offset","computed","_objectSpread","Object","__WEBPACK_IMPORTED_MODULE_1_vuex__","created","__WEBPACK_IMPORTED_MODULE_0_lodash_debounce___default","methods","_this","axios","get","route","params","then","_ref","concat","catch","error","handleError","_this2","patch","_ref2","$root","$emit","$router","push","_this3","post","readAll","forEach","__WEBPACK_IMPORTED_MODULE_4__modules_enso_plugins_date_fns_format__","Date","unreadCount","_this4","_this5","delete","splice","date","__WEBPACK_IMPORTED_MODULE_5__modules_enso_plugins_date_fns_formatDistance__","Component","__webpack_require__","normalizeComponent"],"mappings":"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","file":"43.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('div',{staticClass:\"columns is-centered\"},[_c('div',{staticClass:\"column is-half-desktop\"},[_c('div',{staticClass:\"level is-mobile\"},[(_vm.notifications.length)?_c('div',{staticClass:\"level-item\"},[_c('a',{staticClass:\"button is-success is-outlined\",on:{\"click\":_vm.updateAll}},[_c('span',[_vm._v(_vm._s(_vm.__(\"Mark all read\")))]),_vm._v(\" \"),_c('span',{staticClass:\"icon is-small\"},[_c('fa',{attrs:{\"icon\":\"check\"}})],1)])]):_vm._e(),_vm._v(\" \"),_c('div',{staticClass:\"level-item\"},[_c('a',{class:['button animated fadeIn', {'is-loading': _vm.loading}],on:{\"click\":_vm.fetch}},[_c('span',[_vm._v(_vm._s(_vm.__('Reload')))]),_vm._v(\" \"),_c('span',{staticClass:\"icon is-small\"},[_c('fa',{attrs:{\"icon\":\"sync\"}})],1)])]),_vm._v(\" \"),(_vm.notifications.length)?_c('div',{staticClass:\"level-item is-marginless\"},[_c('a',{staticClass:\"button is-warning is-outlined has-margin-left-small\",on:{\"click\":_vm.destroyAll}},[_c('span',[_vm._v(_vm._s(_vm.__(\"Clear all\")))]),_vm._v(\" \"),_c('span',{staticClass:\"icon is-small\"},[_c('fa',{attrs:{\"icon\":\"trash-alt\"}})],1)])]):_vm._e()]),_vm._v(\" \"),_c('transition-group',{attrs:{\"tag\":\"ul\",\"enter-active-class\":\"fadeIn\",\"leave-active-class\":\"fadeOut\"}},_vm._l((_vm.notifications),function(notification){return _c('li',{key:notification.id,staticClass:\"animated\"},[_c('div',{staticClass:\"box has-background-light has-padding-medium has-margin-bottom-small\",class:{'is-bold': !notification.read_at}},[(notification.data.icon)?_c('fa',{attrs:{\"icon\":notification.data.icon}}):_vm._e(),_vm._v(\" \"),_c('span',{class:[\n                                'is-clickable', {\n                                    'has-text-info':\n                                        notification.data.path\n                                        && notification.data.path !== '#'\n                                }\n                            ],on:{\"click\":function($event){_vm.update(notification)}}},[_vm._v(\"\\n                            \"+_vm._s(notification.data.body)+\"\\n                        \")]),_vm._v(\" \"),_c('span',{staticClass:\"is-pulled-right\"},[_vm._v(\"\\n                            \"+_vm._s(_vm.timeFromNow(notification.created_at))+\"\\n                            \"),_c('a',{staticClass:\"delete has-margin-left-medium is-medium\",on:{\"click\":function($event){_vm.destroy(notification, _vm.index)}}})]),_vm._v(\" \"),_c('span',{staticClass:\"is-clearfix\"})],1)])}),0),_vm._v(\" \"),(!_vm.loading && !_vm.notifications.length)?_c('h4',{staticClass:\"title is-5 has-text-centered\"},[_vm._v(\"\\n                \"+_vm._s(_vm.__(\"You don't have any notifications\"))+\"\\n            \")]):_vm._e()],1)])])}\nvar staticRenderFns = []\nmodule.exports = { render: render, staticRenderFns: staticRenderFns }\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-ba169abe\",\"hasScoped\":false,\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./resources/js/pages/notifications/Index.vue\n// module id = NJDH\n// module chunks = 43","<template>\n    <div>\n        <div class=\"columns is-centered\">\n            <div class=\"column is-half-desktop\">\n                <div class=\"level is-mobile\">\n                    <div class=\"level-item\"\n                        v-if=\"notifications.length\">\n                        <a class=\"button is-success is-outlined\"\n                            @click=\"updateAll\">\n                            <span>{{ __(\"Mark all read\") }}</span>\n                            <span class=\"icon is-small\">\n                                <fa icon=\"check\"/>\n                            </span>\n                        </a>\n                    </div>\n                    <div class=\"level-item\">\n                        <a :class=\"['button animated fadeIn', {'is-loading': loading}]\"\n                            @click=\"fetch\">\n                            <span>{{ __('Reload') }}</span>\n                            <span class=\"icon is-small\">\n                                <fa icon=\"sync\"/>\n                            </span>\n                        </a>\n                    </div>\n                    <div class=\"level-item is-marginless\"\n                        v-if=\"notifications.length\">\n                        <a class=\"button is-warning is-outlined has-margin-left-small\"\n                            @click=\"destroyAll\">\n                            <span>{{ __(\"Clear all\") }}</span>\n                            <span class=\"icon is-small\">\n                                <fa icon=\"trash-alt\"/>\n                            </span>\n                        </a>\n                    </div>\n                </div>\n                <transition-group tag=\"ul\"\n                    enter-active-class=\"fadeIn\"\n                    leave-active-class=\"fadeOut\">\n                    <li class=\"animated\"\n                        v-for=\"notification in notifications\"\n                        :key=\"notification.id\">\n                        <div class=\"box has-background-light has-padding-medium has-margin-bottom-small\"\n                            :class=\"{'is-bold': !notification.read_at}\">\n                            <fa :icon=\"notification.data.icon\"\n                                v-if=\"notification.data.icon\"/>\n                            <span :class=\"[\n                                    'is-clickable', {\n                                        'has-text-info':\n                                            notification.data.path\n                                            && notification.data.path !== '#'\n                                    }\n                                ]\"\n                                @click=\"update(notification)\">\n                                {{ notification.data.body }}\n                            </span>\n                            <span class=\"is-pulled-right\">\n                                {{ timeFromNow(notification.created_at) }}\n                                <a class=\"delete has-margin-left-medium is-medium\"\n                                    @click=\"destroy(notification, index)\"/>\n                            </span>\n                            <span class=\"is-clearfix\"/>\n                        </div>\n                    </li>\n                </transition-group>\n                <h4 class=\"title is-5 has-text-centered\"\n                    v-if=\"!loading && !notifications.length\">\n                    {{ __(\"You don't have any notifications\") }}\n                </h4>\n            </div>\n        </div>\n    </div>\n</template>\n\n<script>\n\nimport debounce from 'lodash/debounce';\nimport { mapState } from 'vuex';\nimport { library } from '@fortawesome/fontawesome-svg-core';\nimport {\n    faBell, faCheck, faTrashAlt, faSpinner, faSync,\n} from '@fortawesome/free-solid-svg-icons';\nimport format from '../../modules/enso/plugins/date-fns/format';\nimport formatDistance from '../../modules/enso/plugins/date-fns/formatDistance';\n\nlibrary.add(faBell, faCheck, faTrashAlt, faSpinner, faSync);\n\nexport default {\n\n    data: () => ({\n        limit: 200,\n        notifications: [],\n        offset: 0,\n        loading: false,\n    }),\n\n    computed: {\n        ...mapState(['user', 'meta']),\n        ...mapState('layout', ['isTouch']),\n    },\n\n    created() {\n        this.fetch = debounce(this.fetch, 500);\n        this.fetch();\n    },\n\n    methods: {\n        fetch() {\n            if (this.loading) {\n                return;\n            }\n\n            this.loading = true;\n\n            axios.get(route('core.notifications.index'), {\n                params: { offset: this.offset, limit: this.limit },\n            }).then(({ data }) => {\n                this.notifications = this.offset ? this.notifications.concat(data) : data;\n                this.offset = this.notifications.length;\n                this.loading = false;\n            }).catch(error => this.handleError(error));\n        },\n        update(notification) {\n            axios.patch(route('core.notifications.update', notification.id))\n                .then(({ data }) => {\n                    notification.read_at = data.read_at;\n                    this.$root.$emit('read-notification', notification);\n\n                    if (notification.data.path && notification.data.path !== '#') {\n                        this.$router.push({ path: notification.data.path });\n                    }\n                }).catch(error => this.handleError(error));\n        },\n        updateAll() {\n            axios.post(route('core.notifications.updateAll'))\n                .then(() => this.readAll())\n                .catch(error => this.handleError(error));\n        },\n        readAll() {\n            this.notifications.forEach((notification) => {\n                notification.read_at = notification.read_at || format(new Date(), 'Y-MM-DD H:mm:s');\n            });\n\n            this.unreadCount = 0;\n\n            this.$root.$emit('read-all-notifications');\n        },\n        destroyAll() {\n            axios.post(route('core.notifications.destroyAll')).then(() => {\n                this.notifications = [];\n                this.$root.$emit('destroy-all-notifications');\n            }).catch(error => this.handleError(error));\n        },\n        destroy(notification, index) {\n            axios.delete(route('core.notifications.destroy', notification.id)).then(() => {\n                this.notifications.splice(index, 1);\n                this.$root.$emit('destroy-notification', notification);\n            }).catch(error => this.handleError(error));\n        },\n        timeFromNow(date) {\n            return formatDistance(date);\n        },\n    },\n};\n\n</script>\n\n\n\n// WEBPACK FOOTER //\n// resources/js/pages/notifications/Index.vue","var normalizeComponent = require(\"!../../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nvar __vue_script__ = require(\"!!babel-loader?{\\\"cacheDirectory\\\":true,\\\"presets\\\":[[\\\"@babel/preset-env\\\",{\\\"modules\\\":false,\\\"targets\\\":{\\\"browsers\\\":[\\\"> 2%\\\"]},\\\"forceAllTransforms\\\":true}]],\\\"plugins\\\":[\\\"@babel/plugin-proposal-object-rest-spread\\\",[\\\"@babel/plugin-transform-runtime\\\",{\\\"helpers\\\":false}],\\\"@babel/plugin-syntax-dynamic-import\\\"]}!../../../../node_modules/vue-loader/lib/selector?type=script&index=0!./Index.vue\")\n/* template */\nvar __vue_template__ = require(\"!!../../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-ba169abe\\\",\\\"hasScoped\\\":false,\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../../node_modules/vue-loader/lib/selector?type=template&index=0!./Index.vue\")\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = null\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nmodule.exports = Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./resources/js/pages/notifications/Index.vue\n// module id = vTXj\n// module chunks = 43"],"sourceRoot":""}